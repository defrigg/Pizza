<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>The Pizza | POS + ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô + ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ</title>
<style>
  :root{
    /* Red-Green refreshed theme */
    --bg:#131414;
    --bg-accent:#171a17;
    --panel:#181a1b;
    --glass:rgba(24,26,27,.72);
    --soft:#202223;
    --soft-2:#2a2d2e;

    --text:#f6f7f7;
    --muted:#cfd6d3;

    --accent:#28a745;    /* green */
    --accent-2:#66bb6a;
    --danger:#e53935;    /* red */
    --danger-2:#ff6b6b;
    --warn:#ffc107;

    --border:#2f3335;
    --shadow:0 10px 30px rgba(0,0,0,.35);
    --radius:16px;
  }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,TH Sarabun New,Prompt,sans-serif;
    color:var(--text);
    background:
      radial-gradient(1000px 600px at -10% -10%, #1e221e 0%, transparent 60%),
      radial-gradient(900px 700px at 110% 10%, #261919 0%, transparent 55%),
      linear-gradient(180deg, var(--bg) 0%, #0f1010 100%);
  }

  /* Header */
  header{
    position:sticky; top:0; z-index:10;
    backdrop-filter:saturate(1.2) blur(8px);
    background:linear-gradient(90deg, #191d19 0%, #1f1717 50%, #191d19 100%);
    border-bottom:1px solid var(--border);
  }
  .wrap{max-width:1200px; margin:0 auto; padding:16px}
  .brand{display:flex; align-items:center; gap:14px}
  .logo{
    width:52px; height:52px; border-radius:14px;
    background:
      radial-gradient(120% 120% at 20% 20%, #ff7a6a 0%, #e53935 45%, #ab2121 60%, #28a745 100%);
    display:grid; place-items:center; font-size:26px; border:2px solid #00000033;
    box-shadow:0 10px 30px #0006, inset 0 0 20px #ffffff22;
  }
  h1{margin:0; font-size:22px; letter-spacing:.2px}
  .sub{color:var(--muted); font-size:13px}
  .ribbon{
    margin-top:10px; display:flex; gap:10px; flex-wrap:wrap
  }
  .chip{
    background:linear-gradient(180deg, #1b1d1e, #141516);
    border:1px solid var(--border); color:var(--muted);
    padding:6px 10px; border-radius:999px; font-size:13px
  }
  .nav{display:flex; gap:8px; flex-wrap:wrap}
  .tab{
    background:linear-gradient(180deg, #202324, #1a1c1d);
    border:1px solid var(--border); padding:9px 14px; border-radius:999px; cursor:pointer;
    color:#e9f9ed; letter-spacing:.2px
  }
  .tab.active{background:linear-gradient(180deg, #1f2a1f, #182018); border-color:#395b39}

  /* Layout */
  main{display:grid; grid-template-columns:1.35fr .65fr; gap:18px; padding:18px}
  @media (max-width:1024px){ main{grid-template-columns:1fr} }

  /* Panel */
  .panel{
    background:var(--glass);
    border:1px solid var(--border);
    border-radius:var(--radius);
    box-shadow:var(--shadow);
    overflow:hidden;
  }
  .panel h2{
    margin:0; padding:14px 16px;
    background:linear-gradient(180deg, #1b1e1f, #141616);
    border-bottom:1px solid var(--border);
    font-size:18px; display:flex; align-items:center; gap:8px
  }
  .panel h2 .dot{width:8px;height:8px;border-radius:50%;display:inline-block;background:var(--accent)}

  /* Menu grid (cards) */
  .menu{display:grid; grid-template-columns:repeat(auto-fill,minmax(230px,1fr)); gap:12px; padding:16px}
  .card{
    background:linear-gradient(180deg, var(--soft) 0%, #17191a 100%);
    border:1px solid var(--border); border-radius:14px; padding:14px;
    display:flex; gap:10px; flex-direction:column;
    transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease;
  }
  .card:hover{transform:translateY(-2px); box-shadow:0 10px 30px #0006; border-color:#355c35}
  .card h3{margin:0; font-size:16px}
  .desc{color:var(--muted); font-size:13px; line-height:1.4; min-height:3.4em}
  .actions{display:flex; gap:8px; margin-top:auto}

  /* Controls */
  button{
    cursor:pointer; border:none; border-radius:12px; padding:10px 12px;
    background:var(--soft-2); color:#fff; border:1px solid var(--border); font-weight:700
  }
  button:hover{filter:brightness(1.05)}
  .btn-add-piece{background:linear-gradient(180deg, #b02523, #8f1d1b); border-color:#7b1a18}
  .btn-add-tray{background:linear-gradient(180deg, #1f7a33, #195e28); border-color:#185326}
  .btn-danger{background:linear-gradient(180deg, #cf2f2c, #9a2422); border-color:#7b1a18}
  .btn-accent{background:linear-gradient(180deg, #2ba84a, #1e7a36); border-color:#1e6a30}
  .btn-warn{background:linear-gradient(180deg, #ffd451, #eab308); color:#1a1200; border-color:#cc9a06}
  .btn-ghost{background:transparent; border-color:#3a3e41; color:#d9dfdc}

  /* Table / cart */
  .cart-body{padding:12px 16px}
  table{width:100%; border-collapse:collapse}
  th,td{padding:10px 8px; border-bottom:1px solid var(--border); font-size:14px}
  th{color:#b9c6bf; font-weight:700; text-align:left}
  td{color:#e7ecea}
  .right{text-align:right}
  .qty{white-space:nowrap}
  .qty-ctrl{display:inline-flex; border:1px solid var(--border); border-radius:999px; overflow:hidden; background:#151717}
  .qty-ctrl button{padding:6px 10px}
  .num{min-width:24px; display:inline-block; text-align:center}
  .muted{color:var(--muted)}

  .cart-tools{display:flex; gap:8px; padding:12px 16px; border-top:1px dashed var(--border); flex-wrap:wrap}
  .summary{padding:12px 16px; border-top:1px solid var(--border); display:grid; gap:8px}
  .summary .row{display:flex; justify-content:space-between; font-size:15px}
  .summary .total{font-size:22px; font-weight:900}

  input[type="number"], input[type="text"], select{
    background:#101212; color:var(--text); border:1px solid var(--border); border-radius:12px; padding:10px 12px; width:100%
  }

  /* Views */
  .view{display:none}
  .view.active{display:block}

  .grid{display:grid; gap:12px; padding:16px}
  .stats{display:grid; grid-template-columns:repeat(auto-fit,minmax(190px,1fr)); gap:12px}
  .stat{
    background:linear-gradient(180deg, #1b1d1e, #141617);
    border:1px solid var(--border); border-radius:14px; padding:12px;
  }
  .stat h3{margin:0 0 6px 0; font-size:13px; color:#9fb0a8; letter-spacing:.2px}
  .val{font-size:22px; font-weight:900}

  /* Footer */
  footer{
    border-top:1px solid var(--border);
    background:linear-gradient(180deg, #161818, #121313);
    color:#9fb0a8; font-size:12px
  }

  /* Print */
  @media print{
    header, .menu, .cart-tools, .nav, .view:not(.pos){display:none !important}
    main{grid-template-columns:1fr !important}
    .panel{border:none; box-shadow:none}
    body{background:#fff; color:#000}
    .summary .total{font-size:18px}
  }
</style>
</head>
<body>
  <header>
    <div class="wrap" style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
      <div class="brand">
        <div class="logo">üçï</div>
        <div>
          <h1>The Pizza</h1>
          <div class="sub">‡πÅ‡∏õ‡πâ‡∏á‡∏ô‡∏∏‡πà‡∏° ‡∏ä‡∏µ‡∏™‡πÄ‡∏¢‡∏¥‡πâ‡∏° ‚Ä¢ POS ‡∏Ç‡∏≤‡∏¢‡∏´‡∏ô‡πâ‡∏≤‡∏£‡πâ‡∏≤‡∏ô</div>
          <div class="ribbon">
            <span class="chip">‡∏ä‡∏¥‡πâ‡∏ô‡∏•‡∏∞ <b>25</b> ‡∏ö‡∏≤‡∏ó</span>
            <span class="chip">‡∏ñ‡∏≤‡∏î‡∏•‡∏∞ <b>189</b> ‡∏ö‡∏≤‡∏ó</span>
            <span class="chip">1 ‡∏ñ‡∏≤‡∏î = <b>8</b> ‡∏ä‡∏¥‡πâ‡∏ô</span>
          </div>
        </div>
      </div>
      <nav class="nav">
        <button class="tab active" data-view="pos">‡∏Ç‡∏≤‡∏¢ (POS)</button>
        <button class="tab" data-view="daily">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô</button>
        <button class="tab" data-view="history">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</button>
      </nav>
    </div>
  </header>

  <!-- POS VIEW -->
  <section class="view pos active">
    <main class="wrap">
      <!-- Menu -->
      <section class="panel">
        <h2><span class="dot"></span> ‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤</h2>
        <div class="menu" id="menuGrid"></div>
      </section>

      <!-- Cart / POS -->
      <section class="panel cart-wrap">
        <h2><span class="dot" style="background:var(--danger)"></span> ‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
        <div class="cart-body">
          <table id="cartTable">
            <thead>
              <tr>
                <th>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th>
                <th class="right">‡∏ä‡∏ô‡∏¥‡∏î</th>
                <th class="right">‡∏£‡∏≤‡∏Ñ‡∏≤/‡∏´‡∏ô‡πà‡∏ß‡∏¢</th>
                <th class="right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
                <th class="right">‡∏£‡∏ß‡∏°</th>
                <th></th>
              </tr>
            </thead>
            <tbody id="cartBody">
              <tr id="emptyRow"><td colspan="6" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</td></tr>
            </tbody>
          </table>
        </div>

        <div class="cart-tools">
          <button class="btn-warn" id="optimizeBtn">‚öñÔ∏è ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î (‡∏à‡∏±‡∏î‡∏ñ‡∏≤‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)</button>
          <button class="btn-danger" id="clearBtn">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
          <span class="chip">‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡∏¥‡∏î‡∏ñ‡∏π‡∏Å‡∏™‡∏∏‡∏î‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á ‚Äú‡∏ä‡∏¥‡πâ‡∏ô‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏ñ‡∏≤‡∏î‚Äù ‡∏ï‡πà‡∏≠‡∏£‡∏™</span>
        </div>

        <div class="summary">
          <div class="row"><span>‡∏¢‡∏≠‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏±‡∏ö</span><span class="right" id="rawSubtotal">0</span></div>
          <div class="row"><span>‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</span><span class="right" id="saving">0</span></div>
          <div class="row total"><span>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span><span class="right" id="grandTotal">0</span></div>

          <div class="row" style="gap:8px; align-items:center; flex-wrap:wrap">
            <span>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞</span>
            <span style="min-width:200px">
              <select id="payMethod">
                <option value="cash">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</option>
                <option value="transfer">‡πÇ‡∏≠‡∏ô</option>
                <option value="card">‡∏ö‡∏±‡∏ï‡∏£</option>
              </select>
            </span>
            <span style="min-width:180px"><input id="cashInput" type="number" min="0" step="1" placeholder="‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î (‡∏ö‡∏≤‡∏ó)"></span>
            <span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span><span class="right" id="change">0</span>
          </div>

          <div class="row" style="gap:8px; align-items:center; flex-wrap:wrap">
            <input id="customerName" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤ (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)" style="max-width:260px" />
            <span class="muted">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Å‡∏î ‚Äú‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô‚Äù ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</span>
          </div>

          <div class="row" style="gap:8px; flex-wrap:wrap">
            <button class="btn-accent" id="checkoutBtn">üí≥ ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏á‡∏¥‡∏ô & ‡∏û‡∏¥‡∏°‡∏û‡πå‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à</button>
            <button class="btn-ghost" id="downloadBtn">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (.json)</button>
          </div>
        </div>

        <!-- Receipt (print view) -->
        <div class="print-only" id="printArea" style="padding:16px">
          <h2 style="margin:8px 0 0 0">The Pizza ‚Äî ‡πÉ‡∏ö‡πÄ‡∏™‡∏£‡πá‡∏à‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</h2>
          <div id="receiptMeta" style="font-size:13px; color:#444"></div>
          <table style="margin-top:8px; width:100%; border-collapse:collapse">
            <thead>
              <tr><th style="text-align:left; padding:6px 0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</th><th class="right">‡∏ä‡∏ô‡∏¥‡∏î</th><th class="right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th><th class="right">‡∏£‡∏≤‡∏Ñ‡∏≤</th></tr>
            </thead>
            <tbody id="receiptBody"></tbody>
          </table>
          <div style="margin-top:8px; display:grid; gap:4px; max-width:360px; margin-left:auto">
            <div style="display:flex; justify-content:space-between"><span>‡∏¢‡∏≠‡∏î‡∏Å‡πà‡∏≠‡∏ô‡∏õ‡∏£‡∏±‡∏ö</span><b id="rRaw">0</b></div>
            <div style="display:flex; justify-content:space-between"><span>‡∏™‡πà‡∏ß‡∏ô‡∏ï‡πà‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î</span><b id="rSave">0</b></div>
            <div style="display:flex; justify-content:space-between; font-size:18px"><span>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span><b id="rTotal">0</b></div>
            <div style="display:flex; justify-content:space-between"><span>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞</span><b id="rPayMethod">-</b></div>
            <div style="display:flex; justify-content:space-between"><span>‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô</span><b id="rCash">0</b></div>
            <div style="display:flex; justify-content:space-between"><span>‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏≠‡∏ô</span><b id="rChange">0</b></div>
          </div>
          <p style="margin-top:12px;font-size:12px;color:#444">‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏≠‡∏∏‡∏î‡∏´‡∏ô‡∏∏‡∏ô üçï</p>
        </div>
      </section>
    </main>
  </section>

  <!-- DAILY VIEW -->
  <section class="view daily">
    <div class="wrap panel">
      <h2><span class="dot"></span> ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢ ‚Äú‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‚Äù</h2>
      <div class="grid">
        <div class="stats">
          <div class="stat"><h3>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</h3><div class="val" id="dSum">0</div></div>
          <div class="stat"><h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•</h3><div class="val" id="dOrders">0</div></div>
          <div class="stat"><h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ä‡∏¥‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</h3><div class="val" id="dSlices">0</div></div>
          <div class="stat"><h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ñ‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏¢</h3><div class="val" id="dTrays">0</div></div>
          <div class="stat"><h3>‡∏Ñ‡πà‡∏≤‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢‡∏ï‡πà‡∏≠‡∏ö‡∏¥‡∏•</h3><div class="val" id="dAvg">0</div></div>
          <div class="stat"><h3>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞ (‡∏™‡∏î/‡πÇ‡∏≠‡∏ô/‡∏ö‡∏±‡∏ï‡∏£)</h3><div class="val" id="dPayMix">-</div></div>
        </div>

        <div>
          <h3 style="margin:0 0 8px 0">10 ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</h3>
          <table id="dLastTable">
            <thead><tr><th>‡πÄ‡∏ß‡∏•‡∏≤</th><th>‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</th><th>‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>

        <div>
          <h3 style="margin:0 0 8px 0">‡πÄ‡∏°‡∏ô‡∏π‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ (Top 5)</h3>
          <table id="dTopTable">
            <thead><tr><th>‡πÄ‡∏°‡∏ô‡∏π</th><th class="right">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ä‡∏¥‡πâ‡∏ô + ‡∏ñ‡∏≤‡∏î*8)</th></tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </section>

  <!-- HISTORY VIEW -->
  <section class="view history">
    <div class="wrap panel">
      <h2><span class="dot"></span> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ (‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô)</h2>
      <div class="grid">
        <div class="stats" style="margin-top:-4px">
          <div class="stat"><h3>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="val" id="mSum">0</div></div>
          <div class="stat"><h3>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="val" id="mOrders">0</div></div>
          <div class="stat"><h3>‡πÄ‡∏â‡∏•‡∏µ‡πà‡∏¢/‡∏ö‡∏¥‡∏• ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3><div class="val" id="mAvg">0</div></div>
        </div>

        <div class="grid" style="padding-top:0">
          <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
            <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô: </label>
            <select id="monthPicker"></select>
            <button class="btn-ghost" id="exportCSV">‚¨áÔ∏è ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å CSV</button>
            <button class="btn-danger" id="wipeData">üóëÔ∏è ‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <span class="muted">* ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ (localStorage)</span>
          </div>

          <div>
            <h3 style="margin:0 0 8px 0">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å</h3>
            <table id="mByDay">
              <thead><tr><th>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</th><th class="right">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ö‡∏¥‡∏•</th><th class="right">‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° (‡∏ö‡∏≤‡∏ó)</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

      </div>
    </div>
  </section>

  <footer>
    <div class="wrap" style="display:flex;justify-content:space-between;align-items:center;gap:8px; padding:14px 16px">
      <div>¬© <span id="yy"></span> The Pizza ‚Äî POS</div>
      <div>‡∏ò‡∏µ‡∏°‡∏™‡∏µ <span style="color:#ff6b6b">‡πÅ‡∏î‡∏á</span> + <span style="color:#76ff9b">‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß</span></div>
    </div>
  </footer>

<script>
/** ---------- CONFIG ---------- */
const PRICE_PER_SLICE = 25;
const PRICE_PER_TRAY  = 189;
const SLICES_PER_TRAY = 8;

/** ---------- MENU ---------- */
const MENU = [
  { id: 'haw',  name: '‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏Æ‡∏≤‡∏ß‡∏≤‡πÄ‡∏≠‡∏µ‡πâ‡∏¢', desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏õ‡∏π‡∏≠‡∏±‡∏î‡πÅ‡∏Æ‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏±‡∏õ‡∏£‡∏î‡πÄ‡∏™‡∏£‡∏¥‡∏ü‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡πÄ‡∏¢‡∏¥‡πâ‡∏°‡πÜ' },
  { id: 'spin', name: '‡∏ú‡∏±‡∏Å‡πÇ‡∏Ç‡∏°‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™',   desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡∏ú‡∏±‡∏Å‡πÇ‡∏Ç‡∏°‡∏Ñ‡∏±‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏Æ‡∏°‡∏´‡∏≠‡∏°‡πÜ ‡∏ä‡∏µ‡∏™‡∏¢‡∏∑‡∏î‡πÜ' },
  { id: 'bac',  name: '‡πÄ‡∏ö‡∏Ñ‡πà‡∏≠‡∏ô‡∏ä‡∏µ‡∏™',       desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡πÄ‡∏≠‡∏≤‡πÉ‡∏à‡∏™‡∏≤‡∏¢‡πÄ‡∏ö‡∏Ñ‡πà‡∏≠‡∏ô‡∏´‡∏≠‡∏°‡πÜ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏µ‡∏™‡∏¢‡∏∑‡∏î‡πÜ' },
  { id: 'saus', name: '‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏µ‡∏™',      desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡πÑ‡∏™‡πâ‡∏Å‡∏£‡∏≠‡∏Å ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏µ‡∏™‡∏¢‡∏∑‡∏î‡πÜ' },
  { id: 'ham',  name: '‡πÅ‡∏Æ‡∏°‡∏ä‡∏µ‡∏™',          desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡πÅ‡∏Æ‡∏°‡∏Ñ‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡πÄ‡∏¢‡∏¥‡πâ‡∏°‡πÜ' },
  { id: 'corn', name: '‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏ä‡∏µ‡∏™',      desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡∏Ç‡πâ‡∏≤‡∏ß‡πÇ‡∏û‡∏î‡∏Ñ‡∏±‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏î‡∏µ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏ä‡∏µ‡∏™‡∏¢‡∏∑‡∏î‡πÜ' },
  { id: 'sea',  name: '‡∏ã‡∏µ‡∏ü‡∏π‡πâ‡∏î',          desc: '‡πÅ‡∏õ‡πâ‡∏á‡∏û‡∏¥‡∏ã‡∏ã‡πà‡∏≤‡∏ô‡∏∏‡πà‡∏°‡πÜ ‡∏¢‡∏Å‡∏ó‡∏∞‡πÄ‡∏•‡∏°‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Å‡∏∏‡πâ‡∏á ‡∏´‡∏≠‡∏¢ ‡∏´‡∏°‡∏∂‡∏Å ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ä‡∏µ‡∏™‡πÄ‡∏¢‡∏¥‡πâ‡∏°‡πÜ' },
];

/** ---------- STORAGE ---------- */
const LS_KEY  = 'thepizza_orders_v1';
const loadOrders = () => JSON.parse(localStorage.getItem(LS_KEY) || '[]');
const saveOrders = (arr) => localStorage.setItem(LS_KEY, JSON.stringify(arr));

/** ---------- STATE ---------- */
let cart = []; // {id, name, type:'slice'|'tray', qty, unit, subtotal}

/** ---------- HELPERS ---------- */
const money = n => (Math.round(n)).toLocaleString('th-TH');
const ymd = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
const ym  = d => `${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}`;
const parseISO = s => new Date(s);

/** ---------- POS CORE ---------- */
function addItem(id, type){
  const menu = MENU.find(m => m.id===id);
  const unit = type==='slice' ? PRICE_PER_SLICE : PRICE_PER_TRAY;
  const key = cart.findIndex(it => it.id===id && it.type===type);
  if(key>-1){ cart[key].qty++; cart[key].subtotal = cart[key].qty * cart[key].unit; }
  else{ cart.push({ id, name:menu.name, type, qty:1, unit, subtotal:unit }); }
  renderCart();
}
function inc(i){ cart[i].qty++; cart[i].subtotal = cart[i].qty*cart[i].unit; renderCart(); }
function dec(i){ cart[i].qty--; if(cart[i].qty<=0){ cart.splice(i,1); } else{ cart[i].subtotal = cart[i].qty*cart[i].unit; } renderCart(); }
function removeRow(i){ cart.splice(i,1); renderCart(); }
function clearCart(){ if(confirm('‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')){ cart = []; renderCart(); } }

function optimize(){
  const byFlavor = {};
  cart.forEach(it=>{
    if(!byFlavor[it.id]) byFlavor[it.id] = { name: it.name, slices:0, trays:0 };
    if(it.type==='slice') byFlavor[it.id].slices += it.qty;
    else byFlavor[it.id].trays += it.qty;
  });
  let newCart = [];
  for(const [id, v] of Object.entries(byFlavor)){
    const totalSlices = v.slices + v.trays*SLICES_PER_TRAY;
    let best = { trays:0, slices:totalSlices, cost: totalSlices*PRICE_PER_SLICE };
    const maxTrays = Math.floor(totalSlices / SLICES_PER_TRAY);
    for(let t=0;t<=maxTrays;t++){
      const s = totalSlices - t*SLICES_PER_TRAY;
      const cost = t*PRICE_PER_TRAY + s*PRICE_PER_SLICE;
      if(cost < best.cost) best = { trays:t, slices:s, cost };
    }
    if(best.trays>0) newCart.push({ id, name:v.name, type:'tray', qty:best.trays, unit:PRICE_PER_TRAY, subtotal:best.trays*PRICE_PER_TRAY });
    if(best.slices>0) newCart.push({ id, name:v.name, type:'slice', qty:best.slices, unit:PRICE_PER_SLICE, subtotal:best.slices*PRICE_PER_SLICE });
  }
  cart = newCart; renderCart(true);
}
function totals(){
  const byFlavor = {};
  cart.forEach(it=>{
    if(!byFlavor[it.id]) byFlavor[it.id]={ slices:0, trays:0 };
    if(it.type==='slice') byFlavor[it.id].slices += it.qty; else byFlavor[it.id].trays += it.qty;
  });
  let bestPrice = 0, sliceOnly = 0;
  for(const f of Object.values(byFlavor)){
    const totalSlices = f.slices + f.trays*SLICES_PER_TRAY;
    bestPrice += f.trays*PRICE_PER_TRAY + f.slices*PRICE_PER_SLICE;
    sliceOnly += totalSlices * PRICE_PER_SLICE;
  }
  const saving = Math.max(0, sliceOnly - bestPrice);
  return { rawSubtotal: sliceOnly, saving, grand: bestPrice };
}
function renderMenu(){
  const g = document.getElementById('menuGrid');
  g.innerHTML = MENU.map(m => `
    <article class="card">
      <h3>${m.name}</h3>
      <p class="desc">${m.desc}</p>
      <div class="actions">
        <button class="btn-add-piece" onclick="addItem('${m.id}','slice')">‚ûï ‡∏ä‡∏¥‡πâ‡∏ô (‡∏ø${PRICE_PER_SLICE})</button>
        <button class="btn-add-tray"  onclick="addItem('${m.id}','tray')">üß∫ ‡∏ñ‡∏≤‡∏î (‡∏ø${PRICE_PER_TRAY})</button>
      </div>
    </article>`).join('');
}
function renderCart(){
  const body = document.getElementById('cartBody');
  body.innerHTML = '';
  if(cart.length===0){
    body.innerHTML = `<tr id="emptyRow"><td colspan="6" class="muted">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</td></tr>`;
  }else{
    cart.forEach((it,i)=>{
      body.insertAdjacentHTML('beforeend', `
        <tr>
          <td>${it.name}</td>
          <td class="right">${it.type==='slice'?'‡∏ä‡∏¥‡πâ‡∏ô':'‡∏ñ‡∏≤‡∏î'}</td>
          <td class="right">‡∏ø${money(it.unit)}</td>
          <td class="right qty">
            <span class="qty-ctrl">
              <button onclick="dec(${i})">‚àí</button>
              <span class="num">${it.qty}</span>
              <button onclick="inc(${i})">+</button>
            </span>
          </td>
          <td class="right">‡∏ø${money(it.subtotal)}</td>
          <td class="right"><button class="btn-danger" onclick="removeRow(${i})">‡∏•‡∏ö</button></td>
        </tr>`);
    });
  }
  const t = totals();
  document.getElementById('rawSubtotal').textContent = '‡∏ø' + money(t.rawSubtotal);
  document.getElementById('saving').textContent = '‡∏ø' + money(t.saving);
  document.getElementById('grandTotal').textContent = '‡∏ø' + money(t.grand);

  const method = document.getElementById('payMethod').value;
  const cash = parseFloat(document.getElementById('cashInput').value||0);
  const change = method==='cash' ? Math.max(0, cash - t.grand) : 0;
  document.getElementById('change').textContent = '‡∏ø' + money(change);
}
function buildReceipt(method, cash, change){
  const now = new Date();
  const meta = [
    `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${now.toLocaleDateString('th-TH',{year:'numeric',month:'long',day:'numeric'})}`,
    `‡πÄ‡∏ß‡∏•‡∏≤: ${now.toLocaleTimeString('th-TH')}`,
    `‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤: ${document.getElementById('customerName').value || '-'}`
  ].join(' | ');
  document.getElementById('receiptMeta').textContent = meta;

  const rBody = document.getElementById('receiptBody'); rBody.innerHTML = '';
  let merged = {};
  cart.forEach(it=>{
    const k = it.id+'-'+it.type;
    if(!merged[k]) merged[k]={ name:it.name, type:it.type, qty:0, subtotal:0 };
    merged[k].qty += it.qty; merged[k].subtotal += it.subtotal;
  });
  Object.values(merged).forEach(it=>{
    rBody.insertAdjacentHTML('beforeend', `
      <tr>
        <td>${it.name}</td>
        <td class="right">${it.type==='slice'?'‡∏ä‡∏¥‡πâ‡∏ô':'‡∏ñ‡∏≤‡∏î'}</td>
        <td class="right">${it.qty}</td>
        <td class="right">‡∏ø${money(it.subtotal)}</td>
      </tr>`);
  });

  const t = totals();
  document.getElementById('rRaw').textContent   = '‡∏ø' + money(t.rawSubtotal);
  document.getElementById('rSave').textContent  = '‡∏ø' + money(t.saving);
  document.getElementById('rTotal').textContent = '‡∏ø' + money(t.grand);
  document.getElementById('rPayMethod').textContent = method==='cash'?'‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î':(method==='transfer'?'‡πÇ‡∏≠‡∏ô':'‡∏ö‡∏±‡∏ï‡∏£');
  document.getElementById('rCash').textContent   = '‡∏ø' + money(cash);
  document.getElementById('rChange').textContent = '‡∏ø' + money(change);
}
function downloadJSON(){
  const data = buildOrderPayload();
  const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a');
  a.href = url; a.download = `order-${Date.now()}.json`; a.click(); URL.revokeObjectURL(url);
}
function buildOrderPayload(){
  const t = totals();
  const method = document.getElementById('payMethod').value;
  const cash = parseFloat(document.getElementById('cashInput').value||0);
  const change = method==='cash' ? Math.max(0, cash - t.grand) : 0;
  const items = cart.map(c => ({ id:c.id, name:c.name, type:c.type, qty:c.qty, unit:c.unit, subtotal:c.subtotal }));
  let totalSlices=0, totalTrays=0;
  items.forEach(i=>{ if(i.type==='slice') totalSlices+=i.qty; else totalTrays+=i.qty; });

  return {
    id: 'O' + Date.now(), ts: new Date().toISOString(),
    customer: document.getElementById('customerName').value || null,
    items, counts: { slices: totalSlices, trays: totalTrays },
    totals: { raw: t.rawSubtotal, saving: t.saving, grand: t.grand },
    payment: { method, cash: method==='cash'?cash:0, change }
  };
}

/** ---------- CHECKOUT ---------- */
function checkout(){
  if(cart.length===0){ alert('‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤'); return; }
  optimize();
  const t = totals();
  const method = document.getElementById('payMethod').value;
  const cash = parseFloat(document.getElementById('cashInput').value||0);
  if(method==='cash' && cash < t.grand){
    alert('‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÑ‡∏°‡πà‡∏û‡∏≠‡∏ä‡∏≥‡∏£‡∏∞'); return;
  }

  const change = method==='cash' ? Math.max(0, cash - t.grand) : 0;
  buildReceipt(method, cash, change);
  window.print();

  const orders = loadOrders();
  orders.push(buildOrderPayload());
  saveOrders(orders);

  cart = [];
  document.getElementById('cashInput').value = '';
  document.getElementById('customerName').value = '';
  renderCart();

  renderDaily(); populateMonths(); renderMonthView();
}

/** ---------- DAILY & MONTHLY ---------- */
function renderDaily(){
  const today = ymd(new Date());
  const orders = loadOrders().filter(o => ymd(parseISO(o.ts)) === today);
  const sum = orders.reduce((s,o)=> s + (o.totals?.grand||0), 0);
  const count = orders.length;
  const avg = count? (sum / count) : 0;
  let slices=0, trays=0; let payCount = { cash:0, transfer:0, card:0 }; let menuCounter = {};
  orders.forEach(o=>{
    slices += o.counts?.slices||0; trays  += o.counts?.trays||0;
    if(o.payment?.method) payCount[o.payment.method]++;
    (o.items||[]).forEach(it=>{
      const eq = it.type==='tray' ? it.qty*SLICES_PER_TRAY : it.qty;
      menuCounter[it.name] = (menuCounter[it.name]||0) + eq;
    });
  });
  document.getElementById('dSum').textContent    = '‡∏ø' + money(sum);
  document.getElementById('dOrders').textContent = money(count);
  document.getElementById('dSlices').textContent = money(slices);
  document.getElementById('dTrays').textContent  = money(trays);
  document.getElementById('dAvg').textContent    = '‡∏ø' + money(avg);
  document.getElementById('dPayMix').textContent = `‡∏™‡∏î ${payCount.cash||0} | ‡πÇ‡∏≠‡∏ô ${payCount.transfer||0} | ‡∏ö‡∏±‡∏ï‡∏£ ${payCount.card||0}`;

  const tbody = document.querySelector('#dLastTable tbody'); tbody.innerHTML = '';
  orders.slice(-10).reverse().forEach(o=>{
    const t = new Date(o.ts);
    tbody.insertAdjacentHTML('beforeend',
      `<tr><td>${t.toLocaleTimeString('th-TH')}</td><td class="right">‡∏ø${money(o.totals.grand)}</td><td>${o.payment.method==='cash'?'‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î':(o.payment.method==='transfer'?'‡πÇ‡∏≠‡∏ô':'‡∏ö‡∏±‡∏ï‡∏£')}</td></tr>`);
  });
  const top = Object.entries(menuCounter).sort((a,b)=>b[1]-a[1]).slice(0,5);
  const tBody = document.querySelector('#dTopTable tbody'); tBody.innerHTML = '';
  top.forEach(([name,eq])=> tBody.insertAdjacentHTML('beforeend', `<tr><td>${name}</td><td class="right">${money(eq)}</td></tr>`));
}
function getAllMonths(){
  const orders = loadOrders();
  const set = new Set(orders.map(o=> ym(parseISO(o.ts)))); set.add(ym(new Date()));
  return Array.from(set).sort().reverse();
}
function populateMonths(){
  const sel = document.getElementById('monthPicker');
  const months = getAllMonths();
  const current = ym(new Date());
  sel.innerHTML = months.map(m => `<option value="${m}" ${m===current?'selected':''}>${m}</option>`).join('');
}
function renderMonthView(){
  const [yy,mm] = document.getElementById('monthPicker').value.split('-').map(x=>parseInt(x,10));
  const orders = loadOrders().filter(o=>{ const d=parseISO(o.ts); return d.getFullYear()===yy && (d.getMonth()+1)===mm; });
  const sum = orders.reduce((s,o)=> s + (o.totals?.grand||0), 0);
  const count = orders.length; const avg = count? (sum / count) : 0;
  document.getElementById('mSum').textContent    = '‡∏ø' + money(sum);
  document.getElementById('mOrders').textContent = money(count);
  document.getElementById('mAvg').textContent    = '‡∏ø' + money(avg);
  const byDay = {}, byDayCount={};
  orders.forEach(o=>{ const d=ymd(parseISO(o.ts)); byDay[d]=(byDay[d]||0)+(o.totals?.grand||0); byDayCount[d]=(byDayCount[d]||0)+1; });
  const tbody = document.querySelector('#mByDay tbody'); tbody.innerHTML = '';
  Object.keys(byDay).sort().forEach(d=> tbody.insertAdjacentHTML('beforeend', `<tr><td>${d}</td><td class="right">${money(byDayCount[d])}</td><td class="right">‡∏ø${money(byDay[d])}</td></tr>`));
}
function exportMonthCSV(){
  const month = document.getElementById('monthPicker').value;
  const [yy,mm] = month.split('-').map(x=>parseInt(x,10));
  const orders = loadOrders().filter(o=>{ const d=parseISO(o.ts); return d.getFullYear()===yy && (d.getMonth()+1)===mm; });
  let lines = ['id,datetime,customer,payment,grand,saving,raw,slices,trays'];
  orders.forEach(o=>{
    const line = [o.id,o.ts,(o.customer||''),(o.payment?.method||''),(o.totals?.grand||0),(o.totals?.saving||0),(o.totals?.raw||0),(o.counts?.slices||0),(o.counts?.trays||0)]
      .map(v => (String(v).includes(',')? `"${String(v).replace(/"/g,'""')}"` : v));
    lines.push(line.join(','));
  });
  const blob = new Blob([lines.join('\n')], {type:'text/csv;charset=utf-8;'});
  const url = URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download=`thepizza-${month}.csv`; a.click(); URL.revokeObjectURL(url);
}
function wipeAllData(){ if(confirm('‡∏•‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏¢‡∏≠‡∏î‡∏Ç‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ö‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏ô‡∏µ‡πâ?')){ localStorage.removeItem(LS_KEY); renderDaily(); populateMonths(); renderMonthView(); } }

/** ---------- NAV + INIT ---------- */
function switchView(view){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.querySelector('.view.'+view).classList.add('active');
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  document.querySelector(`.tab[data-view="${view}"]`).classList.add('active');
  if(view==='daily') renderDaily();
  if(view==='history'){ populateMonths(); renderMonthView(); }
}

function init(){
  document.getElementById('yy').textContent = new Date().getFullYear();

  // Build menu
  const g = document.getElementById('menuGrid');
  g.innerHTML = MENU.map(m => `
    <article class="card">
      <h3>${m.name}</h3>
      <p class="desc">${m.desc}</p>
      <div class="actions">
        <button class="btn-add-piece" onclick="addItem('${m.id}','slice')">‚ûï ‡∏ä‡∏¥‡πâ‡∏ô (‡∏ø${PRICE_PER_SLICE})</button>
        <button class="btn-add-tray"  onclick="addItem('${m.id}','tray')">üß∫ ‡∏ñ‡∏≤‡∏î (‡∏ø${PRICE_PER_TRAY})</button>
      </div>
    </article>`).join('');

  renderCart();

  // POS events
  document.getElementById('optimizeBtn').addEventListener('click', optimize);
  document.getElementById('clearBtn').addEventListener('click', clearCart);
  document.getElementById('cashInput').addEventListener('input', ()=>renderCart(true));
  document.getElementById('payMethod').addEventListener('change', ()=>{
    const pm = document.getElementById('payMethod').value;
    document.getElementById('cashInput').disabled = (pm!=='cash');
    renderCart(true);
  });
  document.getElementById('downloadBtn').addEventListener('click', downloadJSON);
  document.getElementById('checkoutBtn').addEventListener('click', checkout);

  // NAV events
  document.querySelectorAll('.tab').forEach(b=> b.addEventListener('click', ()=> switchView(b.dataset.view)));

  // History defaults
  renderDaily(); populateMonths(); renderMonthView();
}

init();
</script>
</body>
</html>
